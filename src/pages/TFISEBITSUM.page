<!-- User Note: TFIS111EE5RGNDA_Custom Reporting Template With Sub-Totalling Groups -->                                                                                                 
<!-- User Note: This Template Has Value Groups 01-05 Which Automtically Subtotal, Value Groups 10-20 Used For Display Purposes -->                                                                                                  
<!-- User Note: This Template Can Be Used With Up To 13 Reporting Filter Columns (A To M) -->                                                                                                   
<!-- User Note: The Template Is Generic. It Expects Labels 19, 10, 12, 15, 16 & 17 For Each Of The Calculations. Template Only Uses A Single Data Range. -->                                                                                                    
<!-- User Note: Special Features: Income Statement With Specific Calculations for Gross Margin, Operating EBITDA, EBITDA, Net Profit Before Tax And Net Profit After Tax. All Values Reversed. Value Groups 01-05 Automatic Subtotal, Groups 10-20 For Display Purposes. -->                                                                                                    
<!-- REGION 01: GENERAL CONFIGURATION START-->                                                                                                  
<!-- User Note: I Want To Use The Reporting Engine To Generate Reports -->                                                                                                  
<apex:page standardController="ffr__ReportingDefinition__c" extensions="ffr.ReportingTemplateController" readOnly="true" showHeader="true" sidebar="false" standardStylesheets="false" renderas="{!RenderReportAs}">                                                                                                    
<!-- User Note: I Want To Have A Single Format For All Of My Reports So That I Can Style The Fonts And Colors -->                                                                                                   
<!-- User Note: A Standard Stylesheet Has Been Provided In The Static Resources -->                                                                                                 
<!-- User Note: You Can Create Your Own Stylsheet In The Static Resources And Apply It To Your Reports -->                                                                                                  
<!-- User Note: The Style Has Been Designed To Allow Variations Within Different Types Of Reports -->                                                                                                   
<!-- User Note: Change The Last Character From D To S On The Style Classes Applied To Each Line Will Produce A Summary Report -->                                                                                                   
<!-- User Note: A Summary Report Hides The Lowest Level Of Rows But Retains Calculations -->                                                                                                    
<apex:stylesheet value="{!URLFOR($Resource.ffr__ReportingDefaultStyles, 'ReportingDefaultStyles.css')}"/>                                                                                                   
<apex:stylesheet value="{!URLFOR($Resource.ffr__ReportingDefaultStyles, StyleSheetName)}"/>                                                                                                 
<!-- Variable to represent boolean true/false when needing to set other variables to these states -->                                                                                                   
<apex:variable var="true" value="{!1=1}"/>                                                                                                  
<apex:variable var="false" value="{!1=0}"/>                                                                                                 
<!-- User Note: I Want To Format Values On A Report In Different Ways -->                                                                                                   
<!-- User Note: A Number Formatter Component Has Been Provided To Support Different Formats -->                                                                                                 
<!-- User Note: The Coding Structure For The Variable Is As Follows Value/Percent Numberofdecimals Normal/Reversed Brakets/Minus 3Charcterinternationalcurrencycode/None-->                                                                                                 
<!-- User Note: Good Practice Is To Reverse Values Using A Format Rather Than Create Calculations On The Visualforce Page So Running Totals Can Be Easily Maintained-->                                                                                                 
<!-- User Note: You Can Add Your Own Formats To The List Below Try To Keep A Good Coding Structure-->                                                                                                   
<apex:variable var="V2NCB" value="{0, number, #,###,###,##0;(#,###,###,##0)}"/>                                                                                                   
<apex:variable var="P2NCB" value="{0, number, #,###,###,##0%;(#,###,###,##0%)}"/>                                                                                                 
<apex:variable var="V0NCB" value="{0, number, #,###,###,##0;(#,###,###,##0)}"/>                                                                                                 
<apex:variable var="P0NCB" value="{0, number, #,###,###,##0%;(#,###,###,##0%)}"/>                                                                                                   
<apex:variable var="V2RCB" value="{0, number, (#,###,###,##0);#,###,###,##0.00}"/>                                                                                                   
<apex:variable var="P2RCB" value="{0, number, (#,###,###,##0.00%);#,###,###,##0.00%}"/>                                                                                                 
<apex:variable var="V0RCB" value="{0, number, (#,###,###,##0);#,###,###,##0}"/>                                                                                                 
<apex:variable var="P0RCB" value="{0, number, (#,###,###,##0%);#,###,###,##0%}"/>                                                                                                   
<apex:variable var="V2NCBUSD" value="{0, number, $#,###,###,##0);$#,###,###,##0}"/>                                                                                                  
<!-- User Note: I Want To Change All Of The Value Formats Quickly Across The Whole Of The Report -->                                                                                                    
<!-- User Note: Having The Variables Above Assigned To A Second Variable Here Means That Just Changing This Field Will -->                                                                                                  
<!-- User Note: Apply The Results To All The Fields Where It Is Used -->                                                                                                    
<!-- User Note: It Is Possible To Use Individual Variables Against A Line This Method Allows You To Make A Single Change To All Related Formats -->                                                                                                 
<apex:variable var="VN" value="{!V2RCB}"/>                                                                                                  
<apex:variable var="PN" value="{!P2RCB}"/>                                                                                                  
<apex:variable var="VR" value="{!V2NCB}"/>                                                                                                  
<apex:variable var="PR" value="{!P2NCB}"/>                                                                                                  
<apex:variable var="VZ" value="0.00"/>                                                                                                  
<apex:variable var="PZ" value="0.00%"/>                                                                                                 
<!-- This template uses only one data range -->    

<apex:variable var="dataRange" value="{!reportingData['DR01']}"/>                                                                                                   
<!-- Configuration of columns and groups (elastic template responds dynamically to existence of groups and columns -->                                                                                                  
<!-- Column setup -->                                                                                                   
<!-- Set the default column rendering state variables to "false" -->                                                                                                    
<apex:variable var="RenderColumnA" value="{!false}"/>                                                                                                   
<apex:variable var="RenderColumnB" value="{!false}"/>                                                                                                   
<apex:variable var="RenderColumnC" value="{!false}"/>                                                                                                   
<apex:variable var="RenderColumnD" value="{!false}"/>                                                                                                   
<apex:variable var="RenderColumnE" value="{!false}"/>                                                                                                   
<apex:variable var="RenderColumnF" value="{!false}"/>                                                                                                   
<apex:variable var="RenderColumnG" value="{!false}"/>                                                                                                   
<apex:variable var="RenderColumnH" value="{!false}"/>                                                                                                   
<apex:variable var="RenderColumnI" value="{!false}"/>                                                                                                   
<apex:variable var="RenderColumnJ" value="{!false}"/>                                                                                                   
<apex:variable var="RenderColumnK" value="{!false}"/>                                                                                                   
<apex:variable var="RenderColumnL" value="{!false}"/>                                                                                                   
<apex:variable var="RenderColumnM" value="{!false}"/>                                                                                                   
<!-- Set the default column rendering state for calculated columns -->                                                                                                  
<!-- Now set the column rendering state variables according to which columns have been used (via column filter mappings) -->                                                                                                    
<apex:repeat var="columnKey" value="{!dataRange.columnKeyList}">                                                                                                    
<apex:variable var="RenderColumnA" value="{!true}" rendered="{!columnKey=='A'}" />                                                                                                  
<apex:variable var="RenderColumnB" value="{!true}" rendered="{!columnKey=='B'}" />                                                                                                  
<apex:variable var="RenderColumnC" value="{!true}" rendered="{!columnKey=='C'}" />                                                                                                  
<apex:variable var="RenderColumnD" value="{!true}" rendered="{!columnKey=='D'}" />                                                                                                  
<apex:variable var="RenderColumnE" value="{!true}" rendered="{!columnKey=='E'}" />                                                                                                  
<apex:variable var="RenderColumnF" value="{!true}" rendered="{!columnKey=='F'}" />                                                                                                  
<apex:variable var="RenderColumnG" value="{!true}" rendered="{!columnKey=='G'}" />                                                                                                  
<apex:variable var="RenderColumnH" value="{!true}" rendered="{!columnKey=='H'}" />                                                                                                  
<apex:variable var="RenderColumnI" value="{!true}" rendered="{!columnKey=='I'}" />                                                                                                  
<apex:variable var="RenderColumnJ" value="{!true}" rendered="{!columnKey=='J'}" />                                                                                                  
<apex:variable var="RenderColumnK" value="{!true}" rendered="{!columnKey=='K'}" />                                                                                                  
<apex:variable var="RenderColumnL" value="{!true}" rendered="{!columnKey=='L'}" />                                                                                                  
<apex:variable var="RenderColumnM" value="{!true}" rendered="{!columnKey=='M'}" />                                                                                                  
</apex:repeat>                                                                                                  
<!-- Group setup-->                                                                                                 
<!-- Set the default group value rendering state variables to "false" -->                                                                                                   
<apex:variable var="RenderGroup01" value="{!false}"/>                                                                                                   
<apex:variable var="RenderGroup02" value="{!false}"/>                                                                                                   
<apex:variable var="RenderGroup03" value="{!false}"/>                                                                                                   
<apex:variable var="RenderGroup04" value="{!false}"/>                                                                                                   
<apex:variable var="RenderGroup05" value="{!false}"/>                                                                                                   
<apex:variable var="RenderGroup10" value="{!false}"/>                                                                                                   
<apex:variable var="RenderGroup11" value="{!false}"/>                                                                                                   
<apex:variable var="RenderGroup12" value="{!false}"/>                                                                                                   
<apex:variable var="RenderGroup13" value="{!false}"/>                                                                                                   
<apex:variable var="RenderGroup14" value="{!false}"/>                                                                                                   
<apex:variable var="RenderGroup15" value="{!false}"/>                                                                                                   
<apex:variable var="RenderGroup16" value="{!false}"/>                                                                                                   
<apex:variable var="RenderGroup17" value="{!false}"/>                                                                                                   
<apex:variable var="RenderGroup18" value="{!false}"/>                                                                                                   
<apex:variable var="RenderGroup19" value="{!false}"/>                                                                                                   
<apex:variable var="RenderGroup20" value="{!false}"/>                                                                                                   
<!-- We need to know whether to keep group subtotals. Default condition is false -->                                                                                                    
<apex:variable var="RenderGroupSubtotals" value="{!false}"/>                                                                                                    
<!-- Now set the group rendering state variables according to which group values have been used, and count them -->                                                                                                 
<!-- Additionally, if we have any of groups 01-09 we need to maintain group subtotals -->                                                                                                   
<apex:repeat var="groupKey" value="{!dataRange.groupKeyList}">                                                                                                  
<!-- Group-groups -->                                                                                                   
<apex:outputPanel layout="none" rendered="{!groupKey=='01'}">                                                                                                   
<apex:variable var="RenderGroup01" value="{!false}"/>                                                                                                    
<apex:variable var="RenderGroupSubtotals" value="{!false}"/>                                                                                                 
</apex:outputPanel>                                                                                                 
<apex:outputPanel layout="none" rendered="{!groupKey=='02'}">                                                                                                   
<apex:variable var="RenderGroup02" value="{!true}"/>                                                                                                    
<apex:variable var="RenderGroupSubtotals" value="{!true}"/>                                                                                                 
</apex:outputPanel>                                                                                                 
<apex:outputPanel layout="none" rendered="{!groupKey=='03'}">                                                                                                   
<apex:variable var="RenderGroup03" value="{!true}"/>                                                                                                    
<apex:variable var="RenderGroupSubtotals" value="{!true}"/>                                                                                                 
</apex:outputPanel>                                                                                                 
<apex:outputPanel layout="none" rendered="{!groupKey=='04'}">                                                                                                   
<apex:variable var="RenderGroup04" value="{!true}"/>                                                                                                    
<apex:variable var="RenderGroupSubtotals" value="{!true}"/>                                                                                                 
</apex:outputPanel>                                                                                                 
<apex:outputPanel layout="none" rendered="{!groupKey=='05'}">                                                                                                   
<apex:variable var="RenderGroup05" value="{!true}"/>                                                                                                    
<apex:variable var="RenderGroupSubtotals" value="{!true}"/>                                                                                                 
</apex:outputPanel>                                                                                                 
<!-- Line-groups -->                                                                                                    
<apex:variable var="RenderGroup10" value="{!true}" rendered="{!groupKey=='10'}"/> 
<apex:outputPanel layout="none" rendered="{!groupKey=='11'}">
<apex:variable var="RenderGroup11" value="{!true}"/>
</apex:outputPanel>



<apex:variable var="RenderGroup12" value="{!true}" rendered="{!groupKey=='12'}"/>                                                                                                   
<apex:variable var="RenderGroup13" value="{!true}" rendered="{!groupKey=='13'}"/>                                                                                                   
<apex:variable var="RenderGroup14" value="{!true}" rendered="{!groupKey=='14'}"/>                                                                                                   
<apex:variable var="RenderGroup15" value="{!true}" rendered="{!groupKey=='15'}"/>                                                                                                   
<apex:variable var="RenderGroup16" value="{!true}" rendered="{!groupKey=='16'}"/>                                                                                                   
<apex:variable var="RenderGroup17" value="{!true}" rendered="{!groupKey=='17'}"/>                                                                                                   
<apex:variable var="RenderGroup18" value="{!true}" rendered="{!groupKey=='18'}"/>                                                                                                   
<apex:variable var="RenderGroup19" value="{!true}" rendered="{!groupKey=='19'}"/>                                                                                                   
<apex:variable var="RenderGroup20" value="{!true}" rendered="{!groupKey=='20'}"/>                                                                                                   
</apex:repeat>                                                                                                  
<!-- REGION 01: GENERAL CONFIGURATION END -->                                                                                                   
<!-- REGION 02: REPORT HEADER START -->                                                                                                 
<!-- Demand The Report Definition Fields To Be Loaded Even If Data Is Not Found -->                                                                                                 
<apex:outputText value="{!ffr__ReportingDefinition__c.Name}" rendered="false"/>                                                                                                 
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__Description__c}" rendered="false"/>                                                                                                  
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__Title__c}" rendered="false"/>                                                                                                    
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__DisplayPrompts__c}" rendered="false"/>                                                                                                   
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__ReportingTemplate__c}" rendered="false"/>                                                                                                    
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__StyleSheet__c}" rendered="false"/>                                                                                                   
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__PrintStyleSheet__c}" rendered="false"/>                                                                                                  
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__CompanyLogo__c}" rendered="false"/>                                                                                                  
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__PrintChatterFeed__c}" rendered="false"/>                                                                                                 
<!-- User Note: Show The Error Messages From The Reporting Engine -->                                                                                                   
<apex:pageBlock title="Messages" rendered="{!hasMessages}">                                                                                                 
<apex:messages />                                                                                                   
</apex:pageBlock>                                                                                                   
<div class="chatterPosition"></div>                                                                                                 
<!-- User Note: I Want A Consistent Header Format To All Of My Reports With Titles Descriptions And Runtime Prompts Etc -->                                                                                                 
<!-- User Note: When Creating New Templates This Well Formatted Header Should Be Copied And Used Across All The Reports -->                                                                                                 
<table class="ffrgridd">                                                                                                    
<tr>                                                                                                    
<td><apex:image url="{!URLFOR(StaticResourceImages, CompanyLogo)}" rendered="{!DisplayCompanyLogo}" styleClass="logoReport"/></td>                                                                                                  
</tr>                                                                                                   
<tr>                                                                                                    
<td><h1 class="ffrtitle">{!ffr__ReportingDefinition__c.ffr__Title__c}</h1></td>                                                                                                 
<td align="right">{!NOW()}</td>                                                                                                 
</tr>                                                                                                   
<tr><td class="ffrgridspacer2"></td></tr>                                                                                                   
<tr>                                                                                                    
<td><h1 class="ffrname">{!ffr__ReportingDefinition__c.Name}</h1></td>                                                                                                   
<td align="right"><h2 class="ffrwhiteonwhite">{!ffr__ReportingDefinition__c.ffr__ReportingTemplate__c}</h2></td>                                                                                                    
</tr>                                                                                                   
<tr><td class="ffrgridspacer2"></td></tr>                                                                                                   
<tr>                                                                                                    
<td align="left">{!ffr__ReportingDefinition__c.ffr__Description__c}</td>                                                                                                    
<td align="right"><h2 class="ffrwhiteonwhite">{!ffr__ReportingDefinition__c.ffr__StyleSheet__c}</h2></td>                                                                                                   
</tr>                                                                                                   
</table>                                                                                                    
<!-- User Note: Create a new table to display the prompt information -->                                                                                                    
<table class="ffrgridnotfullpage">                                                                                                  
<tr><td class="ffrgridspacer2"></td></tr>                                                                                                   
<tr>                                                                                                    
<td align="left">                                                                                                   
<table class="ffrgrid">                                                                                                 
<apex:repeat value="{!promptList}" var="prompt" >                                                                                                   
<tr>                                                                                                    
<td align="left">{!prompt.label}</td>                                                                                                   
<td align="left" class="ffrgridspacer"></td>                                                                                                    
<td align="left"><strong>{!prompt.value}</strong></td>                                                                                                  
</tr>                                                                                                   
</apex:repeat>                                                                                                  
</table>                                                                                                    
</td>                                                                                                   
</tr>                                                                                                   
</table>                                                                                                    
<!-- User Note: Insert a space after the header -->                                                                                                 
<table class="ffrgrid">                                                                                                 
<tr><td class="ffrgridspacer"></td></tr>                                                                                                    
</table>                                                                                                    
<!-- REGION 02: REPORT HEADER END -->                                                                                                   
<!-- REGION 03: REPORT BODY START -->                                                                                                   
<table class="ffrgridnotfullpage">                                                                                                 
<!-- Column headings -->                                                                                                    
<!-- Note that these are contained within outputPanels which are rendered (displayed) depending on the appropriate column render state variable -->                                                                                                 
<!-- Groups 1-9 are groups with sub-totals (groups), 10- are groups without sub-totals (lines) -->                                                                                                  
<tr>      

<th class="{!if(RenderGroup01,'ffrcalcsumlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup01}">{!dataRange.groupLabels['01']}</apex:outputPanel></th>                                                                                             
<!--
<th class="{!if(RenderGroup02,'ffrcalcsumlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup02}">{!dataRange.groupLabels['02']}</apex:outputPanel></th>                                                                                                 

<th class="{!if(RenderGroup03,'ffrcalcsumlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup03}">{!dataRange.groupLabels['03']}</apex:outputPanel></th>                                                                                                 
<th class="{!if(RenderGroup04,'ffrcalcsumlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup04}">{!dataRange.groupLabels['04']}</apex:outputPanel></th>                                                                                                 
<th class="{!if(RenderGroup05,'ffrcalcsumlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup05}">{!dataRange.groupLabels['05']}</apex:outputPanel></th>                                                                                                 
<th class="{!if(RenderGroup10,'ffrcalcsumlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup10}">{!dataRange.groupLabels['10']}</apex:outputPanel></th>                                                                                                 
<th class="{!if(RenderGroup11,'ffrcalcsumlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup11}">{!dataRange.groupLabels['11']}</apex:outputPanel></th>                                                                                                 
-->
<td class="ffrgridspacer"/>  
<th class="{!if(RenderGroup12,'ffrcalcsumlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup12}">{!dataRange.groupLabels['12']}</apex:outputPanel></th>                                                                                                 
<th class="{!if(RenderGroup13,'ffrcalcsumlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup13}">{!dataRange.groupLabels['13']}</apex:outputPanel></th>                                                                                                 
<th class="{!if(RenderGroup14,'ffrcalcsumlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup14}">{!dataRange.groupLabels['14']}</apex:outputPanel></th>                                                                                                 
<th class="{!if(RenderGroup15,'ffrcalcsumlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup15}">{!dataRange.groupLabels['15']}</apex:outputPanel></th>                                                                                                 
<th class="{!if(RenderGroup16,'ffrcalcsumlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup16}">{!dataRange.groupLabels['16']}</apex:outputPanel></th>                                                                                                 
<th class="{!if(RenderGroup17,'ffrcalcsumlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup17}">{!dataRange.groupLabels['17']}</apex:outputPanel></th>                                                                                                 
<th class="{!if(RenderGroup18,'ffrcalcsumlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup18}">{!dataRange.groupLabels['18']}</apex:outputPanel></th>                                                                                                 
<th class="{!if(RenderGroup19,'ffrcalcsumlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup19}">{!dataRange.groupLabels['19']}</apex:outputPanel></th>                                                                                                 
<th class="{!if(RenderGroup20,'ffrcalcsumlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup20}">{!dataRange.groupLabels['20']}</apex:outputPanel></th>                                                                                                 
<td class="ffrgridspacer"/>                                                                                                 
<th class="{!if(RenderColumnA,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnA}">{!dataRange.columnLabels['A']}</apex:outputPanel></th>                                                                                                    
<th class="{!if(RenderColumnB,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnB}">{!dataRange.columnLabels['B']}</apex:outputPanel></th>                                                                                                    
<th class="{!if(RenderColumnC,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnC}">{!dataRange.columnLabels['C']}</apex:outputPanel></th>                                                                                                    
<th class="{!if(RenderColumnD,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnD}">{!dataRange.columnLabels['D']}</apex:outputPanel></th>                                                                                                    
<th class="{!if(RenderColumnE,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnE}">{!dataRange.columnLabels['E']}</apex:outputPanel></th>                                                                                                    
<th class="{!if(RenderColumnF,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnF}">{!dataRange.columnLabels['F']}</apex:outputPanel></th>                                                                                                    
<th class="{!if(RenderColumnG,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnG}">{!dataRange.columnLabels['G']}</apex:outputPanel></th>                                                                                                    
<th class="{!if(RenderColumnH,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnH}">{!dataRange.columnLabels['H']}</apex:outputPanel></th>                                                                                                    
<th class="{!if(RenderColumnI,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnI}">{!dataRange.columnLabels['I']}</apex:outputPanel></th>                                                                                                    
<th class="{!if(RenderColumnJ,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnJ}">{!dataRange.columnLabels['J']}</apex:outputPanel></th>                                                                                                    
<th class="{!if(RenderColumnK,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnK}">{!dataRange.columnLabels['K']}</apex:outputPanel></th>                                                                                                    
<th class="{!if(RenderColumnL,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnL}">{!dataRange.columnLabels['L']}</apex:outputPanel></th>                                                                                                    
<th class="{!if(RenderColumnM,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnM}">{!dataRange.columnLabels['M']}</apex:outputPanel></th>                                                                                                    
</tr>                                                                                                   
<!-- Set all column grand-totals to zero (if the column is in use - determined by column render state variables) -->                                                                                                    
<apex:variable value="{!0}" var="grandTotalColumnA" rendered="{!RenderColumnA}"/>                                                                                                   
<apex:variable value="{!0}" var="grandTotalColumnB" rendered="{!RenderColumnB}"/>                                                                                                   
<apex:variable value="{!0}" var="grandTotalColumnC" rendered="{!RenderColumnC}"/>                                                                                                   
<apex:variable value="{!0}" var="grandTotalColumnD" rendered="{!RenderColumnD}"/>                                                                                                   
<apex:variable value="{!0}" var="grandTotalColumnE" rendered="{!RenderColumnE}"/>                                                                                                   
<apex:variable value="{!0}" var="grandTotalColumnF" rendered="{!RenderColumnF}"/>                                                                                                   
<apex:variable value="{!0}" var="grandTotalColumnG" rendered="{!RenderColumnG}"/>                                                                                                   
<apex:variable value="{!0}" var="grandTotalColumnH" rendered="{!RenderColumnH}"/>                                                                                                   
<apex:variable value="{!0}" var="grandTotalColumnI" rendered="{!RenderColumnI}"/>                                                                                                   
<apex:variable value="{!0}" var="grandTotalColumnJ" rendered="{!RenderColumnJ}"/>                                                                                                   
<apex:variable value="{!0}" var="grandTotalColumnK" rendered="{!RenderColumnK}"/>                                                                                                   
<apex:variable value="{!0}" var="grandTotalColumnL" rendered="{!RenderColumnL}"/>                                                                                                   
<apex:variable value="{!0}" var="grandTotalColumnM" rendered="{!RenderColumnM}"/>                                                                                                   
<!-- We need to track whether or not various calculations have been displayed - this defaults to false --> 

<apex:variable value="{!false}" var="ReturnsExchangesDiscountsDisplayed"/> 
<apex:variable value="{!false}" var="OperatingIncomeCalculationsDisplayed"/>                                                                                                 
<apex:variable value="{!false}" var="GrossMarginCalculationsDisplayed"/>                                                                                                    
<apex:variable value="{!false}" var="OperatingEbitdaCalculationsDisplayed"/>                                                                                                    
<apex:variable value="{!false}" var="ebitdaCalculationsDisplayed"/>                                                                                                 
<apex:variable value="{!false}" var="netProfitBeforeTaxCalculationsDisplayed"/>                                                                                                 
<!-- Iterate over the Rows -->                                                                                                  
<apex:repeat value="{!dataRange.rowList}" var="row" >                                                                                                   
<!-- Setup for start of row -->                                                                                                 
<apex:variable var="rowKeyNum" value="{!VALUE(row.key)}"/>  
<!--
<!-- Display the Returns, Exchanges and Discounts -->                                                                                                    
<apex:outputPanel layout="none" rendered="{!!ReturnsExchangesDiscountsDisplayed  && rowKeyNum<>1 && rowKeyNum>4}">                                                                                                    
<!-- Display Returns Exchanges and Discounts -->                                                                                                   
<!--<tr>                                                                                                    
<td class="ffrgridtitleleftd" colspan="11">{!label['L21']}</td>                                                                                                  
<td class="ffrgridspacerd"/>                                                                                                    
<td class="{!if(RenderColumnA,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnA==0,VZ,VN)}" rendered="{!RenderColumnA}"><apex:param value="{!grandTotalColumnA}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnB,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnB==0,VZ,VN)}" rendered="{!RenderColumnB}"><apex:param value="{!grandTotalColumnB}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnC,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnC==0,VZ,VN)}" rendered="{!RenderColumnC}"><apex:param value="{!grandTotalColumnC}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnD,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnD==0,VZ,VN)}" rendered="{!RenderColumnD}"><apex:param value="{!grandTotalColumnD}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnE,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnE==0,VZ,VN)}" rendered="{!RenderColumnE}"><apex:param value="{!grandTotalColumnE}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnF,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnF==0,VZ,VN)}" rendered="{!RenderColumnF}"><apex:param value="{!grandTotalColumnF}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnG,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnG==0,VZ,VN)}" rendered="{!RenderColumnG}"><apex:param value="{!grandTotalColumnG}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnH,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnH==0,VZ,VN)}" rendered="{!RenderColumnH}"><apex:param value="{!grandTotalColumnH}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnI,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnI==0,VZ,VN)}" rendered="{!RenderColumnI}"><apex:param value="{!grandTotalColumnI}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnJ,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnJ==0,VZ,VN)}" rendered="{!RenderColumnJ}"><apex:param value="{!grandTotalColumnJ}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnK,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnK==0,VZ,VN)}" rendered="{!RenderColumnK}"><apex:param value="{!grandTotalColumnK}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnL,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnL==0,VZ,VN)}" rendered="{!RenderColumnL}"><apex:param value="{!grandTotalColumnL}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnM,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnM==0,VZ,VN)}" rendered="{!RenderColumnM}"><apex:param value="{!grandTotalColumnM}"/></apex:outputText></td>                                                                                                 
</tr>    -->

                                                                                               
<!-- Spacer -->                                                                                                 
<tr><td class="ffrgridspacerd" colspan="11"></td></tr>                                                                                                  
<!-- Set the flag to indicate that we have displayed Returns, Exchanges and Discounts -->                                                                                                  
<apex:variable value="{!true}" var="ReturnsExchangesDiscountsDisplayed"/>                                                                                                 
</apex:outputPanel>           
<!--
<!-- Display the Operating Income calculations if they have not been displayed and all the Operating Income rows have been processed -->                                                                                                    
<!--<apex:outputPanel layout="none" rendered="{!!OperatingIncomeCalculationsDisplayed && rowKeyNum>6}">              -->                                                                                      
<!-- Display Operating Income -->                                                                                                   
<!--<tr>                                                                                                    
<td class="ffrgridtitleleftd" colspan="11">{!label['L19']}</td>                                                                                                  
<td class="ffrgridspacerd"/>                                                                                                    
<td class="{!if(RenderColumnA,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnA==0,VZ,VR)}" rendered="{!RenderColumnA}"><apex:param value="{!grandTotalColumnA}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnB,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnB==0,VZ,VR)}" rendered="{!RenderColumnB}"><apex:param value="{!grandTotalColumnB}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnC,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnC==0,VZ,VR)}" rendered="{!RenderColumnC}"><apex:param value="{!grandTotalColumnC}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnD,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnD==0,VZ,VR)}" rendered="{!RenderColumnD}"><apex:param value="{!grandTotalColumnD}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnE,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnE==0,VZ,VR)}" rendered="{!RenderColumnE}"><apex:param value="{!grandTotalColumnE}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnF,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnF==0,VZ,VR)}" rendered="{!RenderColumnF}"><apex:param value="{!grandTotalColumnF}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnG,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnG==0,VZ,VR)}" rendered="{!RenderColumnG}"><apex:param value="{!grandTotalColumnG}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnH,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnH==0,VZ,VR)}" rendered="{!RenderColumnH}"><apex:param value="{!grandTotalColumnH}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnI,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnI==0,VZ,VR)}" rendered="{!RenderColumnI}"><apex:param value="{!grandTotalColumnI}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnJ,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnJ==0,VZ,VR)}" rendered="{!RenderColumnJ}"><apex:param value="{!grandTotalColumnJ}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnK,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnK==0,VZ,VR)}" rendered="{!RenderColumnK}"><apex:param value="{!grandTotalColumnK}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnL,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnL==0,VZ,VR)}" rendered="{!RenderColumnL}"><apex:param value="{!grandTotalColumnL}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnM,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnM==0,VZ,VR)}" rendered="{!RenderColumnM}"><apex:param value="{!grandTotalColumnM}"/></apex:outputText></td>                                                                                                 
</tr>                                                                                                  
<!-- Spacer                                                                                                 
<tr><td class="ffrgridspacerd" colspan="11"></td></tr>                                                                                                  
<!-- Set the flag to indicate that we have displayed Operating Income Calculations -->                                                                                                  
<!--<apex:variable value="{!true}" var="OperatingIncomeCalculationsDisplayed"/>                                                                                                 
</apex:outputPanel>      -->                                                                                                                        


<!-- Display the Gross Margin calculations if they have not been displayed and all the Gross Margin rows have been processed -->                                                                                                    
<apex:outputPanel layout="none" rendered="{!!GrossMarginCalculationsDisplayed && rowKeyNum>20}">                                                                                                    
<!-- Display Gross Margin -->                                                                                                   
<tr>                                                                                                    
<td class="ffrgridtitleleftd" colspan="11">{!label['L10']}</td>                                                                                                  
<td class="ffrgridspacerd"/>                                                                                                    
<td class="{!if(RenderColumnA,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnA==0,VZ,VR)}" rendered="{!RenderColumnA}"><apex:param value="{!grandTotalColumnA}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnB,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnB==0,VZ,VR)}" rendered="{!RenderColumnB}"><apex:param value="{!grandTotalColumnB}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnC,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnC==0,VZ,VR)}" rendered="{!RenderColumnC}"><apex:param value="{!grandTotalColumnC}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnD,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnD==0,VZ,VR)}" rendered="{!RenderColumnD}"><apex:param value="{!grandTotalColumnD}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnE,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnE==0,VZ,VR)}" rendered="{!RenderColumnE}"><apex:param value="{!grandTotalColumnE}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnF,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnF==0,VZ,VR)}" rendered="{!RenderColumnF}"><apex:param value="{!grandTotalColumnF}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnG,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnG==0,VZ,VR)}" rendered="{!RenderColumnG}"><apex:param value="{!grandTotalColumnG}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnH,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnH==0,VZ,VR)}" rendered="{!RenderColumnH}"><apex:param value="{!grandTotalColumnH}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnI,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnI==0,VZ,VR)}" rendered="{!RenderColumnI}"><apex:param value="{!grandTotalColumnI}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnJ,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnJ==0,VZ,VR)}" rendered="{!RenderColumnJ}"><apex:param value="{!grandTotalColumnJ}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnK,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnK==0,VZ,VR)}" rendered="{!RenderColumnK}"><apex:param value="{!grandTotalColumnK}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnL,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnL==0,VZ,VR)}" rendered="{!RenderColumnL}"><apex:param value="{!grandTotalColumnL}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnM,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnM==0,VZ,VR)}" rendered="{!RenderColumnM}"><apex:param value="{!grandTotalColumnM}"/></apex:outputText></td>                                                                                                 
</tr>                                                                                                   
<!-- Spacer -->                                                                                                 
<tr><td class="ffrgridspacerd" colspan="11"></td></tr>                                                                                                  
<!-- Set the flag to indicate that we have displayed Gross Margin Calculations -->                                                                                                  
<apex:variable value="{!true}" var="GrossMarginCalculationsDisplayed"/>                                                                                                 
</apex:outputPanel>                                                                                                 
<!-- Display the Operating EBITDA calculations if they have not been displayed and all the Operating EBITDA rows have been processed -->                                                                                                    
<apex:outputPanel layout="none" rendered="{!!OperatingEbitdaCalculationsDisplayed && rowKeyNum>39}">                                                                                                    
<!-- Display Operating EBITDA -->                                                                                                   
<tr>                                                                                                    
<td class="ffrgridtitleleftd" colspan="11">{!label['L15']}</td>                                                                                                  
<td class="ffrgridspacerd"/>                                                                                                    
<td class="{!if(RenderColumnA,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnA==0,VZ,VR)}" rendered="{!RenderColumnA}"><apex:param value="{!grandTotalColumnA}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnB,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnB==0,VZ,VR)}" rendered="{!RenderColumnB}"><apex:param value="{!grandTotalColumnB}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnC,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnC==0,VZ,VR)}" rendered="{!RenderColumnC}"><apex:param value="{!grandTotalColumnC}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnD,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnD==0,VZ,VR)}" rendered="{!RenderColumnD}"><apex:param value="{!grandTotalColumnD}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnE,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnE==0,VZ,VN)}" rendered="{!RenderColumnE}"><apex:param value="{!grandTotalColumnE}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnF,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnF==0,VZ,VN)}" rendered="{!RenderColumnF}"><apex:param value="{!grandTotalColumnF}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnG,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnG==0,VZ,VN)}" rendered="{!RenderColumnG}"><apex:param value="{!grandTotalColumnG}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnH,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnH==0,VZ,VN)}" rendered="{!RenderColumnH}"><apex:param value="{!grandTotalColumnH}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnI,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnI==0,VZ,VN)}" rendered="{!RenderColumnI}"><apex:param value="{!grandTotalColumnI}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnJ,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnJ==0,VZ,VN)}" rendered="{!RenderColumnJ}"><apex:param value="{!grandTotalColumnJ}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnK,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnK==0,VZ,VN)}" rendered="{!RenderColumnK}"><apex:param value="{!grandTotalColumnK}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnL,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnL==0,VZ,VN)}" rendered="{!RenderColumnL}"><apex:param value="{!grandTotalColumnL}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnM,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnM==0,VZ,VN)}" rendered="{!RenderColumnM}"><apex:param value="{!grandTotalColumnM}"/></apex:outputText></td>                                                                                                 
</tr>                                                                                                   
<!-- Spacer -->                                                                                                 
<tr><td class="ffrgridspacerd" colspan="11"></td></tr>                                                                                                  
<!-- Set the flag to indicate that we have displayed Operating EBITDA Calculations -->                                                                                                  
<apex:variable value="{!true}" var="OperatingEbitdaCalculationsDisplayed"/>                                                                                                 
</apex:outputPanel>                                                                                                 
<!-- Display the EBITDA calculations if they have not been displayed and all the EBITDA rows have been processed -->                                                                                                    
<apex:outputPanel layout="none" rendered="{!!ebitdaCalculationsDisplayed && rowKeyNum>49}">                                                                                                 
<!-- Display EBITDA -->                                                                                                 
<tr>                                                                                                    
<td class="ffrgridtitleleftd" colspan="11">{!label['L16']}</td>                                                                                                  
<td class="ffrgridspacerd"/>                                                                                                    
<td class="{!if(RenderColumnA,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnA==0,VZ,VR)}" rendered="{!RenderColumnA}"><apex:param value="{!grandTotalColumnA}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnB,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnB==0,VZ,VR)}" rendered="{!RenderColumnB}"><apex:param value="{!grandTotalColumnB}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnC,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnC==0,VZ,VR)}" rendered="{!RenderColumnC}"><apex:param value="{!grandTotalColumnC}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnD,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnD==0,VZ,VR)}" rendered="{!RenderColumnD}"><apex:param value="{!grandTotalColumnD}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnE,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnE==0,VZ,VN)}" rendered="{!RenderColumnE}"><apex:param value="{!grandTotalColumnE}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnF,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnF==0,VZ,VN)}" rendered="{!RenderColumnF}"><apex:param value="{!grandTotalColumnF}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnG,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnG==0,VZ,VN)}" rendered="{!RenderColumnG}"><apex:param value="{!grandTotalColumnG}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnH,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnH==0,VZ,VN)}" rendered="{!RenderColumnH}"><apex:param value="{!grandTotalColumnH}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnI,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnI==0,VZ,VN)}" rendered="{!RenderColumnI}"><apex:param value="{!grandTotalColumnI}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnJ,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnJ==0,VZ,VN)}" rendered="{!RenderColumnJ}"><apex:param value="{!grandTotalColumnJ}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnK,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnK==0,VZ,VN)}" rendered="{!RenderColumnK}"><apex:param value="{!grandTotalColumnK}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnL,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnL==0,VZ,VN)}" rendered="{!RenderColumnL}"><apex:param value="{!grandTotalColumnL}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnM,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnM==0,VZ,VN)}" rendered="{!RenderColumnM}"><apex:param value="{!grandTotalColumnM}"/></apex:outputText></td>                                                                                                 
</tr>                                                                                                  
<!-- Spacer -->                                                                                                 
<tr><td class="ffrgridspacerd" colspan="11"></td></tr>                                                                                                  
<!-- Set the flag to indicate that we have displayed EBITDA Calculations -->                                                                                                    
<apex:variable value="{!true}" var="ebitdaCalculationsDisplayed"/>                                                                                                  
</apex:outputPanel>                                                                                                 
<!-- Display the Net Profit Before Tax calculations if they have not been displayed and all the Net Profit Before Tax rows have been processed -->                                                                                                  
<apex:outputPanel layout="none" rendered="{!!netProfitBeforeTaxCalculationsDisplayed && rowKeyNum>59}">                                                                                                 
<!-- Display Net Profit Before Tax -->                                                                                                  

<tr>                                                                                                    
<td class="ffrgridtitleleftd" colspan="11">{!label['L17']}</td>                                                                                                  
<td class="ffrgridspacerd"/>                                                                                                    
<td class="{!if(RenderColumnA,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnA==0,VZ,VN)}" rendered="{!RenderColumnA}"><apex:param value="{!grandTotalColumnA}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnB,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnB==0,VZ,VN)}" rendered="{!RenderColumnB}"><apex:param value="{!grandTotalColumnB}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnC,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnC==0,VZ,VN)}" rendered="{!RenderColumnC}"><apex:param value="{!grandTotalColumnC}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnD,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnD==0,VZ,VN)}" rendered="{!RenderColumnD}"><apex:param value="{!grandTotalColumnD}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnE,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnE==0,VZ,VN)}" rendered="{!RenderColumnE}"><apex:param value="{!grandTotalColumnE}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnF,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnF==0,VZ,VN)}" rendered="{!RenderColumnF}"><apex:param value="{!grandTotalColumnF}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnG,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnG==0,VZ,VN)}" rendered="{!RenderColumnG}"><apex:param value="{!grandTotalColumnG}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnH,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnH==0,VZ,VN)}" rendered="{!RenderColumnH}"><apex:param value="{!grandTotalColumnH}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnI,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnI==0,VZ,VN)}" rendered="{!RenderColumnI}"><apex:param value="{!grandTotalColumnI}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnJ,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnJ==0,VZ,VN)}" rendered="{!RenderColumnJ}"><apex:param value="{!grandTotalColumnJ}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnK,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnK==0,VZ,VN)}" rendered="{!RenderColumnK}"><apex:param value="{!grandTotalColumnK}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnL,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnL==0,VZ,VN)}" rendered="{!RenderColumnL}"><apex:param value="{!grandTotalColumnL}"/></apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnM,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnM==0,VZ,VN)}" rendered="{!RenderColumnM}"><apex:param value="{!grandTotalColumnM}"/></apex:outputText></td>                                                                                                 
</tr>                                                                                                  
<!-- Spacer -->                                                                                                 
<tr><td class="ffrgridspacerd" colspan="11"></td></tr>                                                                                                  
<!-- Set the flag to indicate that we have displayed Net Profit Before Tax Calculations -->                                                                                                 
<apex:variable value="{!true}" var="netProfitBeforeTaxCalculationsDisplayed"/>                                                                                                  
</apex:outputPanel>                                                                                                 
<!-- For each row, reset all column row-totals and subtotals to zero (if the column is in use - determined by column render state variables) -->                                                                                                    
<apex:variable value="{!0}" var="rowTotalColumnA" rendered="{!RenderColumnA}"/>                                                                                                 
<apex:variable value="{!0}" var="rowTotalColumnB" rendered="{!RenderColumnB}"/>                                                                                                 
<apex:variable value="{!0}" var="rowTotalColumnC" rendered="{!RenderColumnC}"/>                                                                                                 
<apex:variable value="{!0}" var="rowTotalColumnD" rendered="{!RenderColumnD}"/>                                                                                                 
<apex:variable value="{!0}" var="rowTotalColumnE" rendered="{!RenderColumnE}"/>                                                                                                 
<apex:variable value="{!0}" var="rowTotalColumnF" rendered="{!RenderColumnF}"/>                                                                                                 
<apex:variable value="{!0}" var="rowTotalColumnG" rendered="{!RenderColumnG}"/>                                                                                                 
<apex:variable value="{!0}" var="rowTotalColumnH" rendered="{!RenderColumnH}"/>                                                                                                 
<apex:variable value="{!0}" var="rowTotalColumnI" rendered="{!RenderColumnI}"/>                                                                                                 
<apex:variable value="{!0}" var="rowTotalColumnJ" rendered="{!RenderColumnJ}"/>                                                                                                 
<apex:variable value="{!0}" var="rowTotalColumnK" rendered="{!RenderColumnK}"/>                                                                                                 
<apex:variable value="{!0}" var="rowTotalColumnL" rendered="{!RenderColumnL}"/>                                                                                                 
<apex:variable value="{!0}" var="rowTotalColumnM" rendered="{!RenderColumnM}"/>                                                                                                 
<apex:variable value="{!0}" var="rowSubtotalColumnA" rendered="{!RenderColumnA}"/>                                                                                                  
<apex:variable value="{!0}" var="rowSubtotalColumnB" rendered="{!RenderColumnB}"/>                                                                                                  
<apex:variable value="{!0}" var="rowSubtotalColumnC" rendered="{!RenderColumnC}"/>                                                                                                  
<apex:variable value="{!0}" var="rowSubtotalColumnD" rendered="{!RenderColumnD}"/>                                                                                                  
<apex:variable value="{!0}" var="rowSubtotalColumnE" rendered="{!RenderColumnE}"/>                                                                                                  
<apex:variable value="{!0}" var="rowSubtotalColumnF" rendered="{!RenderColumnF}"/>                                                                                                  
<apex:variable value="{!0}" var="rowSubtotalColumnG" rendered="{!RenderColumnG}"/>                                                                                                  
<apex:variable value="{!0}" var="rowSubtotalColumnH" rendered="{!RenderColumnH}"/>                                                                                                  
<apex:variable value="{!0}" var="rowSubtotalColumnI" rendered="{!RenderColumnI}"/>                                                                                                  
<apex:variable value="{!0}" var="rowSubtotalColumnJ" rendered="{!RenderColumnJ}"/>                                                                                                  
<apex:variable value="{!0}" var="rowSubtotalColumnK" rendered="{!RenderColumnK}"/>                                                                                                  
<apex:variable value="{!0}" var="rowSubtotalColumnL" rendered="{!RenderColumnL}"/>                                                                                                  
<apex:variable value="{!0}" var="rowSubtotalColumnM" rendered="{!RenderColumnM}"/>                                                                                                  
<!-- These variables are used to determine when to print a subtotal -->                                                                                                 
<apex:variable var="previousLineGroup01" value=""/>                                                                                           
<apex:variable var="previousLineGroup02" value=""/>                                                                                                 
<apex:variable var="previousLineGroup03" value=""/>                                                                                                 
<apex:variable var="previousLineGroup04" value=""/>                                                                                                 
<apex:variable var="previousLineGroup05" value=""/>                                                                                                 
<apex:variable var="currentLineGroup01" value=""/>                                                                                                  
<apex:variable var="currentLineGroup02" value=""/>                                                                                                  
<apex:variable var="currentLineGroup03" value=""/>                                                                                                  
<apex:variable var="currentLineGroup04" value=""/>                                                                                                  
<apex:variable var="currentLineGroup05" value=""/>                                                                                                  
<!-- This variable is used to determine whether the line is the first line in the row - to prevent a subtotal being printed before the first line -->                                                                                                   
<apex:variable var="firstLine" value="{!true}"/>                                                                                                    
<!-- Iterate over the Lines -->                                                                                                 
<apex:repeat value="{!row.lineList}" var="line" >                                                                                                   
<!-- Display the line and process subtotals -->                                                                                                 
<!-- Set the variables representing the groups for the current line for comparison with the previous line -->                                                                                                   
<apex:variable value="{!line.groups['01']}" var="currentLineGroup01" rendered="{!RenderGroup01}"/>                                                                                                  
<apex:variable value="{!line.groups['02']}" var="currentLineGroup02" rendered="{!RenderGroup02}"/>                                                                                                  
<apex:variable value="{!line.groups['03']}" var="currentLineGroup03" rendered="{!RenderGroup03}"/>                                                                                                  
<apex:variable value="{!line.groups['04']}" var="currentLineGroup04" rendered="{!RenderGroup04}"/>                                                                                                  
<apex:variable value="{!line.groups['05']}" var="currentLineGroup05" rendered="{!RenderGroup05}"/>                                                                                                  
<!-- Mid-row subtotal line -->                                                                                                  
<!-- Do we want to process a (mid-row) subtotal line? -->                                                                                                   
<apex:variable var="doSubtotal" value="{!RenderGroupSubtotals && !firstLine && (currentLineGroup01!=previousLineGroup01 || currentLineGroup02!=previousLineGroup02 || currentLineGroup03!=previousLineGroup03|| currentLineGroup04!=previousLineGroup04|| currentLineGroup05!=previousLineGroup05)}"/>                                                                                                  
<!-- Process a subtotal line -->                                                                                                    
<!-- Display the group-group values but not the group-line values -->                                                                                                   
<tr>                                                                                                    
<td class="{!if(doSubtotal && RenderGroup01,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup01}">{!previousLineGroup01}</apex:outputPanel></td>                                                                                
<td class="{!if(doSubtotal && RenderGroup02,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup02}">{!previousLineGroup02}</apex:outputPanel></td>                                                                                                 
<!--
<td class="{!if(doSubtotal && RenderGroup03,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup03}">{!previousLineGroup03}</apex:outputPanel></td>                                                                                                 
<td class="{!if(doSubtotal && RenderGroup04,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup04}">{!previousLineGroup04}</apex:outputPanel></td>                                                                                                 
<td class="{!if(doSubtotal && RenderGroup05,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup05}">{!previousLineGroup05}</apex:outputPanel></td>                                                                                                 
<td class="{!if(doSubtotal && RenderGroup10,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup10}"></apex:outputPanel></td>                                                                                                   
-->
<td class="{!if(doSubtotal && RenderGroup11,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup11}"></apex:outputPanel></td>                                                                                                   
<td class="{!if(doSubtotal && RenderGroup12,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup12}"></apex:outputPanel></td>                                                                                                   

<td class="{!if(doSubtotal && RenderGroup13,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup13}"></apex:outputPanel></td>                                                                                                   
<td class="{!if(doSubtotal && RenderGroup14,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup14}"></apex:outputPanel></td>                                                                                                   
<td class="{!if(doSubtotal && RenderGroup15,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup15}"></apex:outputPanel></td>                                                                                                   
<td class="{!if(doSubtotal && RenderGroup16,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup16}"></apex:outputPanel></td>                                                                                                   
<td class="{!if(doSubtotal && RenderGroup17,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup17}"></apex:outputPanel></td>                                                                                                   
<td class="{!if(doSubtotal && RenderGroup18,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup18}"></apex:outputPanel></td>                                                                                                   
<td class="{!if(doSubtotal && RenderGroup19,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup19}"></apex:outputPanel></td>                                                                                                   
<td class="{!if(doSubtotal && RenderGroup20,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup20}"></apex:outputPanel></td>                                                                                                   
<!--<td class="{!if(doSubtotal,'ffrgridspacerd','ffrhidden')}"></td>      -->                                                                                         
<td class="{!if(doSubtotal && RenderColumnA,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnA==0,VZ,VN)}" rendered="{!doSubtotal && RenderColumnA}"><apex:param value="{!rowSubtotalColumnA}"/></apex:outputText></td>                                                                                                  
<td class="{!if(doSubtotal && RenderColumnB,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnB==0,VZ,VN)}" rendered="{!doSubtotal && RenderColumnB}"><apex:param value="{!rowSubtotalColumnB}"/></apex:outputText></td>                                                                                                  
<td class="{!if(doSubtotal && RenderColumnC,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnC==0,VZ,VN)}" rendered="{!doSubtotal && RenderColumnC}"><apex:param value="{!rowSubtotalColumnC}"/></apex:outputText></td>                                                                                                  
<td class="{!if(doSubtotal && RenderColumnD,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnD==0,VZ,VN)}" rendered="{!doSubtotal && RenderColumnD}"><apex:param value="{!rowSubtotalColumnD}"/></apex:outputText></td>                                                                                                  
<td class="{!if(doSubtotal && RenderColumnE,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnE==0,VZ,VN)}" rendered="{!doSubtotal && RenderColumnE}"><apex:param value="{!rowSubtotalColumnE}"/></apex:outputText></td>                                                                                                  
<td class="{!if(doSubtotal && RenderColumnF,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnF==0,VZ,VN)}" rendered="{!doSubtotal && RenderColumnF}"><apex:param value="{!rowSubtotalColumnF}"/></apex:outputText></td>                                                                                                  
<td class="{!if(doSubtotal && RenderColumnG,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnG==0,VZ,VN)}" rendered="{!doSubtotal && RenderColumnG}"><apex:param value="{!rowSubtotalColumnG}"/></apex:outputText></td>                                                                                                  
<td class="{!if(doSubtotal && RenderColumnH,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnH==0,VZ,VN)}" rendered="{!doSubtotal && RenderColumnH}"><apex:param value="{!rowSubtotalColumnH}"/></apex:outputText></td>                                                                                                  
<td class="{!if(doSubtotal && RenderColumnI,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnI==0,VZ,VN)}" rendered="{!doSubtotal && RenderColumnI}"><apex:param value="{!rowSubtotalColumnI}"/></apex:outputText></td>                                                                                                  
<td class="{!if(doSubtotal && RenderColumnJ,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnJ==0,VZ,VN)}" rendered="{!doSubtotal && RenderColumnJ}"><apex:param value="{!rowSubtotalColumnJ}"/></apex:outputText></td>                                                                                                  
<td class="{!if(doSubtotal && RenderColumnK,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnK==0,VZ,VN)}" rendered="{!doSubtotal && RenderColumnK}"><apex:param value="{!rowSubtotalColumnK}"/></apex:outputText></td>                                                                                                  
<td class="{!if(doSubtotal && RenderColumnL,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnL==0,VZ,VN)}" rendered="{!doSubtotal && RenderColumnL}"><apex:param value="{!rowSubtotalColumnL}"/></apex:outputText></td>                                                                                                  
<td class="{!if(doSubtotal && RenderColumnM,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnM==0,VZ,VN)}" rendered="{!doSubtotal && RenderColumnM}"><apex:param value="{!rowSubtotalColumnM}"/></apex:outputText></td>                                                                                                  
</tr>                                                                                                   
<!-- Reset the subtotals -->                                                                                                    
<apex:variable value="{!0}" var="rowSubtotalColumnA" rendered="{!doSubtotal && RenderColumnA}"/>                                                                                                    
<apex:variable value="{!0}" var="rowSubtotalColumnB" rendered="{!doSubtotal && RenderColumnB}"/>                                                                                                    
<apex:variable value="{!0}" var="rowSubtotalColumnC" rendered="{!doSubtotal && RenderColumnC}"/>                                                                                                    
<apex:variable value="{!0}" var="rowSubtotalColumnD" rendered="{!doSubtotal && RenderColumnD}"/>                                                                                                    
<apex:variable value="{!0}" var="rowSubtotalColumnE" rendered="{!doSubtotal && RenderColumnE}"/>                                                                                                    
<apex:variable value="{!0}" var="rowSubtotalColumnF" rendered="{!doSubtotal && RenderColumnF}"/>                                                                                                    
<apex:variable value="{!0}" var="rowSubtotalColumnG" rendered="{!doSubtotal && RenderColumnG}"/>                                                                                                    
<apex:variable value="{!0}" var="rowSubtotalColumnH" rendered="{!doSubtotal && RenderColumnH}"/>                                                                                                    
<apex:variable value="{!0}" var="rowSubtotalColumnI" rendered="{!doSubtotal && RenderColumnI}"/>                                                                                                    
<apex:variable value="{!0}" var="rowSubtotalColumnJ" rendered="{!doSubtotal && RenderColumnJ}"/>                                                                                                    
<apex:variable value="{!0}" var="rowSubtotalColumnK" rendered="{!doSubtotal && RenderColumnK}"/>                                                                                                    
<apex:variable value="{!0}" var="rowSubtotalColumnL" rendered="{!doSubtotal && RenderColumnL}"/>                                                                                                    
<apex:variable value="{!0}" var="rowSubtotalColumnM" rendered="{!doSubtotal && RenderColumnM}"/>                                                                                                    
<!-- Line setup -->                                                                                                 
<!-- Use the column render state variable (e.g. "renderColumnA" determines whether the panel for column A is configured and rendered) -->                                                                                                   
<!-- For each column, add the column value to the sub-total - column-row totals are updated separately -->                                                                                                  
<apex:variable value="{!rowSubtotalColumnA+line.columns['A'].values['A']}" var="rowSubtotalColumnA" rendered="{!RenderColumnA}"/>                                                                                                   
<apex:variable value="{!rowSubtotalColumnB+line.columns['B'].values['A']}" var="rowSubtotalColumnB" rendered="{!RenderColumnB}"/>                                                                                                   
<apex:variable value="{!rowSubtotalColumnC+line.columns['C'].values['A']}" var="rowSubtotalColumnC" rendered="{!RenderColumnC}"/>                                                                                                   
<apex:variable value="{!rowSubtotalColumnD+line.columns['D'].values['A']}" var="rowSubtotalColumnD" rendered="{!RenderColumnD}"/>                                                                                                   
<apex:variable value="{!rowSubtotalColumnE+line.columns['E'].values['A']}" var="rowSubtotalColumnE" rendered="{!RenderColumnE}"/>                                                                                                   
<apex:variable value="{!rowSubtotalColumnF+line.columns['F'].values['A']}" var="rowSubtotalColumnF" rendered="{!RenderColumnF}"/>                                                                                                   
<apex:variable value="{!rowSubtotalColumnG+line.columns['G'].values['A']}" var="rowSubtotalColumnG" rendered="{!RenderColumnG}"/>                                                                                                   
<apex:variable value="{!rowSubtotalColumnH+line.columns['H'].values['A']}" var="rowSubtotalColumnH" rendered="{!RenderColumnH}"/>                                                                                                   
<apex:variable value="{!rowSubtotalColumnI+line.columns['I'].values['A']}" var="rowSubtotalColumnI" rendered="{!RenderColumnI}"/>                                                                                                   
<apex:variable value="{!rowSubtotalColumnJ+line.columns['J'].values['A']}" var="rowSubtotalColumnJ" rendered="{!RenderColumnJ}"/>                                                                                                   
<apex:variable value="{!rowSubtotalColumnK+line.columns['K'].values['A']}" var="rowSubtotalColumnK" rendered="{!RenderColumnK}"/>                                                                                                   
<apex:variable value="{!rowSubtotalColumnL+line.columns['L'].values['A']}" var="rowSubtotalColumnL" rendered="{!RenderColumnL}"/>                                                                                                   
<apex:variable value="{!rowSubtotalColumnM+line.columns['M'].values['A']}" var="rowSubtotalColumnM" rendered="{!RenderColumnM}"/>                                                                                                   
<!-- Display the line -->                                                                                                   
<!-- Display the grouping values based on render settings -->                                                                                                   
<tr>                                                                                                    
<td class="{!if(RenderGroup01,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup01}">{!currentLineGroup01}</apex:outputPanel></td>                                                                                                   
<!--
<td class="{!if(RenderGroup02,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup02}">{!currentLineGroup02}</apex:outputPanel></td>                                                                                                   
-->
<!--
<td class="{!if(RenderGroup03,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup03}">{!currentLineGroup03}</apex:outputPanel></td>                                                                                                   
<td class="{!if(RenderGroup04,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup04}">{!currentLineGroup04}</apex:outputPanel></td>                                                                                                   
<td class="{!if(RenderGroup05,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup05}">{!currentLineGroup05}</apex:outputPanel></td>                                                                                                   
<td class="{!if(RenderGroup10,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup10}">{!line.groups['10']}</apex:outputPanel></td> 
-->                                                                                                   
<td class="{!if(RenderGroup11,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup11}">{!line.groups['11']}</apex:outputPanel></td>                                                                                                    
<td class="{!if(RenderGroup12,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup12}">{!line.groups['12']}</apex:outputPanel></td>                                                                                                    
<td class="{!if(RenderGroup13,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup13}">{!line.groups['13']}</apex:outputPanel></td>                                                                                                    
<td class="{!if(RenderGroup14,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup14}">{!line.groups['14']}</apex:outputPanel></td>                                                                                                    
<td class="{!if(RenderGroup15,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup15}">{!line.groups['15']}</apex:outputPanel></td>                                                                                                    
<td class="{!if(RenderGroup16,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup16}">{!line.groups['16']}</apex:outputPanel></td>                                                                                                    
<td class="{!if(RenderGroup17,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup17}">{!line.groups['17']}</apex:outputPanel></td>                                                                                                    
<td class="{!if(RenderGroup18,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup18}">{!line.groups['18']}</apex:outputPanel></td>                                                                                                    
<td class="{!if(RenderGroup19,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup19}">{!line.groups['19']}</apex:outputPanel></td>                                                                                                    
<td class="{!if(RenderGroup20,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup20}">{!line.groups['20']}</apex:outputPanel></td>                                                                                                    
<td class="ffrgridspacerd"/>                                                                                                    
<td class="{!if(RenderColumnA,'ffrgridrowd','ffrhidden')}">                                                                                                 
<apex:outputText value="{!if(line.columns['A'].values['A']==0,VZ,VN)}" rendered="{!RenderColumnA}">                                                                                                 
<apex:param value="{!line.columns['A'].values['A']}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnB,'ffrgridrowd','ffrhidden')}">                                                                                                 
<apex:outputText value="{!if(line.columns['B'].values['A']==0,VZ,VN)}" rendered="{!RenderColumnB}">                                                                                                 
<apex:param value="{!line.columns['B'].values['A']}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnC,'ffrgridrowd','ffrhidden')}">                                                                                                 
<apex:outputText value="{!if(line.columns['C'].values['A']==0,VZ,VN)}" rendered="{!RenderColumnC}">                                                                                                 
<apex:param value="{!line.columns['C'].values['A']}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnD,'ffrgridrowd','ffrhidden')}">                                                                                                 
<apex:outputText value="{!if(line.columns['D'].values['A']==0,VZ,VN)}" rendered="{!RenderColumnD}">                                                                                                 
<apex:param value="{!line.columns['D'].values['A']}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnE,'ffrgridrowd','ffrhidden')}">                                                                                                 
<apex:outputText value="{!if(line.columns['E'].values['A']==0,VZ,VN)}" rendered="{!RenderColumnE}">                                                                                                 
<apex:param value="{!line.columns['E'].values['A']}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnF,'ffrgridrowd','ffrhidden')}">                                                                                                 
<apex:outputText value="{!if(line.columns['F'].values['A']==0,VZ,VN)}" rendered="{!RenderColumnF}">                                                                                                 
<apex:param value="{!line.columns['F'].values['A']}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnG,'ffrgridrowd','ffrhidden')}">                                                                                                 
<apex:outputText value="{!if(line.columns['G'].values['A']==0,VZ,VN)}" rendered="{!RenderColumnG}">                                                                                                 
<apex:param value="{!line.columns['G'].values['A']}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnH,'ffrgridrowd','ffrhidden')}">                                                                                                 
<apex:outputText value="{!if(line.columns['H'].values['A']==0,VZ,VN)}" rendered="{!RenderColumnH}">                                                                                                 
<apex:param value="{!line.columns['H'].values['A']}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnI,'ffrgridrowd','ffrhidden')}">                                                                                                 
<apex:outputText value="{!if(line.columns['I'].values['A']==0,VZ,VN)}" rendered="{!RenderColumnI}">                                                                                                 
<apex:param value="{!line.columns['I'].values['A']}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnJ,'ffrgridrowd','ffrhidden')}">                                                                                                 
<apex:outputText value="{!if(line.columns['J'].values['A']==0,VZ,VN)}" rendered="{!RenderColumnJ}">                                                                                                 
<apex:param value="{!line.columns['J'].values['A']}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnK,'ffrgridrowd','ffrhidden')}">                                                                                                 
<apex:outputText value="{!if(line.columns['K'].values['A']==0,VZ,VN)}" rendered="{!RenderColumnK}">                                                                                                 
<apex:param value="{!line.columns['K'].values['A']}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnL,'ffrgridrowd','ffrhidden')}">                                                                                                 
<apex:outputText value="{!if(line.columns['L'].values['A']==0,VZ,VN)}" rendered="{!RenderColumnL}">                                                                                                 
<apex:param value="{!line.columns['L'].values['A']}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnM,'ffrgridrowd','ffrhidden')}">                                                                                                 
<apex:outputText value="{!if(line.columns['M'].values['A']==0,VZ,VN)}" rendered="{!RenderColumnM}">                                                                                                 
<apex:param value="{!line.columns['M'].values['A']}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
</tr>                                                                                                   
<!-- Setup for next line -->                                                                                                    
<!-- Record the group values as "previous" for comparison on the next line -->                                                                                                  
<apex:variable var="previousLineGroup01" value="{!currentLineGroup01}"/>                                                                                                    
<apex:variable var="previousLineGroup02" value="{!currentLineGroup02}"/>                                                                                                    
<apex:variable var="previousLineGroup03" value="{!currentLineGroup03}"/>                                                                                                    
<apex:variable var="previousLineGroup04" value="{!currentLineGroup04}"/>                                                                                                    
<apex:variable var="previousLineGroup05" value="{!currentLineGroup05}"/>                                                                                                    
<!-- If this was the first line, it was completed, so set first line to false -->                                                                                                   
<apex:variable var="firstLine" value="{!false}" rendered="{!firstLine}" />                                                                                                  
<!-- Add the values to the row-column totals -->                                                                                                    
<apex:variable value="{!rowTotalColumnA+line.columns['A'].values['A']}" var="rowTotalColumnA" rendered="{!RenderColumnA}"/>                                                                                                 
<apex:variable value="{!rowTotalColumnB+line.columns['B'].values['A']}" var="rowTotalColumnB" rendered="{!RenderColumnB}"/>                                                                                                 
<apex:variable value="{!rowTotalColumnC+line.columns['C'].values['A']}" var="rowTotalColumnC" rendered="{!RenderColumnC}"/>                                                                                                 
<apex:variable value="{!rowTotalColumnD+line.columns['D'].values['A']}" var="rowTotalColumnD" rendered="{!RenderColumnD}"/>                                                                                                 
<apex:variable value="{!rowTotalColumnE+line.columns['E'].values['A']}" var="rowTotalColumnE" rendered="{!RenderColumnE}"/>                                                                                                 
<apex:variable value="{!rowTotalColumnF+line.columns['F'].values['A']}" var="rowTotalColumnF" rendered="{!RenderColumnF}"/>                                                                                                 
<apex:variable value="{!rowTotalColumnG+line.columns['G'].values['A']}" var="rowTotalColumnG" rendered="{!RenderColumnG}"/>                                                                                                 
<apex:variable value="{!rowTotalColumnH+line.columns['H'].values['A']}" var="rowTotalColumnH" rendered="{!RenderColumnH}"/>                                                                                                 
<apex:variable value="{!rowTotalColumnI+line.columns['I'].values['A']}" var="rowTotalColumnI" rendered="{!RenderColumnI}"/>                                                                                                 
<apex:variable value="{!rowTotalColumnJ+line.columns['J'].values['A']}" var="rowTotalColumnJ" rendered="{!RenderColumnJ}"/>                                                                                                 
<apex:variable value="{!rowTotalColumnK+line.columns['K'].values['A']}" var="rowTotalColumnK" rendered="{!RenderColumnK}"/>                                                                                                 
<apex:variable value="{!rowTotalColumnL+line.columns['L'].values['A']}" var="rowTotalColumnL" rendered="{!RenderColumnL}"/>                                                                                                 
<apex:variable value="{!rowTotalColumnM+line.columns['M'].values['A']}" var="rowTotalColumnM" rendered="{!RenderColumnM}"/>                                                                                                 
</apex:repeat> <!-- Go to next line -->                                                                                                 
<!-- Do we want to process an end-of-row subtotal line? -->                                                                                                 
<!-- Display the group-group values but not the group-line values -->                                                                                                   
<apex:outputPanel layout="none" rendered="{!RenderGroupSubtotals}">                                                                                                 
<tr>                                                                                                    
<td class="{!if(RenderGroup01,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup01}">{!previousLineGroup01}</apex:outputPanel></td>                                                                                                 
<td class="{!if(RenderGroup02,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup02}">{!previousLineGroup02}</apex:outputPanel></td>                                                                                                 
<!--
<td class="{!if(RenderGroup03,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup03}">{!previousLineGroup03}</apex:outputPanel></td>                                                                                                 
<td class="{!if(RenderGroup04,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup04}">{!previousLineGroup04}</apex:outputPanel></td>                                                                                                 
<td class="{!if(RenderGroup05,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup05}">{!previousLineGroup05}</apex:outputPanel></td>                                                                                                 
<td class="{!if(RenderGroup10,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup10}"></apex:outputPanel></td>                                                                                                   
-->
<td class="{!if(RenderGroup11,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup11}"></apex:outputPanel></td>                                                                                                   
<td class="{!if(RenderGroup12,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup12}"></apex:outputPanel></td>                                                                                                   
<td class="{!if(RenderGroup13,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup13}"></apex:outputPanel></td>                                                                                                   
<td class="{!if(RenderGroup14,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup14}"></apex:outputPanel></td>                                                                                                   
<td class="{!if(RenderGroup15,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup15}"></apex:outputPanel></td>                                                                                                   
<td class="{!if(RenderGroup16,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup16}"></apex:outputPanel></td>                                                                                                   
<td class="{!if(RenderGroup17,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup17}"></apex:outputPanel></td>                                                                                                   
<td class="{!if(RenderGroup18,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup18}"></apex:outputPanel></td>                                                                                                   
<td class="{!if(RenderGroup19,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup19}"></apex:outputPanel></td>                                                                                                   
<td class="{!if(RenderGroup20,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup20}"></apex:outputPanel></td>                                                                                                   
<!--td class="ffrgridspacerd"/>  -->                                                                                              
<td class="{!if(RenderColumnA,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnA==0,VZ,VN)}" rendered="{!RenderColumnA}"><apex:param value="{!rowSubtotalColumnA}"/></apex:outputText></td>                                                                                                  
<td class="{!if(RenderColumnB,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnB==0,VZ,VN)}" rendered="{!RenderColumnB}"><apex:param value="{!rowSubtotalColumnB}"/></apex:outputText></td>                                                                                                  
<td class="{!if(RenderColumnC,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnC==0,VZ,VN)}" rendered="{!RenderColumnC}"><apex:param value="{!rowSubtotalColumnC}"/></apex:outputText></td>                                                                                                  
<td class="{!if(RenderColumnD,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnD==0,VZ,VN)}" rendered="{!RenderColumnD}"><apex:param value="{!rowSubtotalColumnD}"/></apex:outputText></td>                                                                                                  
<td class="{!if(RenderColumnE,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnE==0,VZ,VN)}" rendered="{!RenderColumnE}"><apex:param value="{!rowSubtotalColumnE}"/></apex:outputText></td>                                                                                                  
<td class="{!if(RenderColumnF,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnF==0,VZ,VN)}" rendered="{!RenderColumnF}"><apex:param value="{!rowSubtotalColumnF}"/></apex:outputText></td>                                                                                                  
<td class="{!if(RenderColumnG,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnG==0,VZ,VN)}" rendered="{!RenderColumnG}"><apex:param value="{!rowSubtotalColumnG}"/></apex:outputText></td>                                                                                                  
<td class="{!if(RenderColumnH,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnH==0,VZ,VN)}" rendered="{!RenderColumnH}"><apex:param value="{!rowSubtotalColumnH}"/></apex:outputText></td>                                                                                                  
<td class="{!if(RenderColumnI,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnI==0,VZ,VN)}" rendered="{!RenderColumnI}"><apex:param value="{!rowSubtotalColumnI}"/></apex:outputText></td>                                                                                                  
<td class="{!if(RenderColumnJ,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnJ==0,VZ,VN)}" rendered="{!RenderColumnJ}"><apex:param value="{!rowSubtotalColumnJ}"/></apex:outputText></td>                                                                                                  
<td class="{!if(RenderColumnK,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnK==0,VZ,VN)}" rendered="{!RenderColumnK}"><apex:param value="{!rowSubtotalColumnK}"/></apex:outputText></td>                                                                                                  
<td class="{!if(RenderColumnL,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnL==0,VZ,VN)}" rendered="{!RenderColumnL}"><apex:param value="{!rowSubtotalColumnL}"/></apex:outputText></td>                                                                                                  
<td class="{!if(RenderColumnM,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(rowSubtotalColumnM==0,VZ,VN)}" rendered="{!RenderColumnM}"><apex:param value="{!rowSubtotalColumnM}"/></apex:outputText></td>                                                                                                  
</tr>                                                                                                   
</apex:outputPanel>                                                                                                 
<!-- Setup for end of row -->                                                                                                   
<!-- Add the row-total to the grand-total so that the grand-total accumulates across all the rows -->                                                                                                   
<!-- Note that the row-totals are reset for each successive row -->                                                                                                 
<apex:variable value="{!grandTotalColumnA+rowTotalColumnA}" var="grandTotalColumnA" rendered="{!RenderColumnA}"/>                                                                                                   
<apex:variable value="{!grandTotalColumnB+rowTotalColumnB}" var="grandTotalColumnB" rendered="{!RenderColumnB}"/>                                                                                                   
<apex:variable value="{!grandTotalColumnC+rowTotalColumnC}" var="grandTotalColumnC" rendered="{!RenderColumnC}"/>                                                                                                   
<apex:variable value="{!grandTotalColumnD+rowTotalColumnD}" var="grandTotalColumnD" rendered="{!RenderColumnD}"/>                                                                                                   
<apex:variable value="{!grandTotalColumnE+rowTotalColumnE}" var="grandTotalColumnE" rendered="{!RenderColumnE}"/>                                                                                                   
<apex:variable value="{!grandTotalColumnF+rowTotalColumnF}" var="grandTotalColumnF" rendered="{!RenderColumnF}"/>                                                                                                   
<apex:variable value="{!grandTotalColumnG+rowTotalColumnG}" var="grandTotalColumnG" rendered="{!RenderColumnG}"/>                                                                                                   
<apex:variable value="{!grandTotalColumnH+rowTotalColumnH}" var="grandTotalColumnH" rendered="{!RenderColumnH}"/>                                                                                                   
<apex:variable value="{!grandTotalColumnI+rowTotalColumnI}" var="grandTotalColumnI" rendered="{!RenderColumnI}"/>                                                                                                   
<apex:variable value="{!grandTotalColumnJ+rowTotalColumnJ}" var="grandTotalColumnJ" rendered="{!RenderColumnJ}"/>                                                                                                   
<apex:variable value="{!grandTotalColumnK+rowTotalColumnK}" var="grandTotalColumnK" rendered="{!RenderColumnK}"/>                                                                                                   
<apex:variable value="{!grandTotalColumnL+rowTotalColumnL}" var="grandTotalColumnL" rendered="{!RenderColumnL}"/>                                                                                                   
<apex:variable value="{!grandTotalColumnM+rowTotalColumnM}" var="grandTotalColumnM" rendered="{!RenderColumnM}"/>                                                                                                   
<!-- Display the row totals -->                                                                                                 
<!-- Display the title for the row-total - which is the row label -->                                                                                                   
<!-- The td tag needs to span the number of groups being rendered -->                                                                                                   
<tr>                                                                                                    
<td class="ffrcalcsumlabeld" colspan="11">{!row.label}</td>                                                                                                 
<td class="ffrgridspacerd"/>                                                                                                    
<td class="{!if(RenderColumnA,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(rowTotalColumnA==0,VZ,VN)}" rendered="{!RenderColumnA}">                                                                                                    
<apex:param value="{!rowTotalColumnA}"/>                                                                                                    
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnB,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(rowTotalColumnB==0,VZ,VN)}" rendered="{!RenderColumnB}">                                                                                                    
<apex:param value="{!rowTotalColumnB}"/>                                                                                                    
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnC,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(rowTotalColumnC==0,VZ,VN)}" rendered="{!RenderColumnC}">                                                                                                    
<apex:param value="{!rowTotalColumnC}"/>                                                                                                    
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnD,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(rowTotalColumnD==0,VZ,VN)}" rendered="{!RenderColumnD}">                                                                                                    
<apex:param value="{!rowTotalColumnD}"/>                                                                                                    
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnE,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(rowTotalColumnE==0,VZ,VN)}" rendered="{!RenderColumnE}">                                                                                                    
<apex:param value="{!rowTotalColumnE}"/>                                                                                                    
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnF,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(rowTotalColumnF==0,VZ,VN)}" rendered="{!RenderColumnF}">                                                                                                    
<apex:param value="{!rowTotalColumnF}"/>                                                                                                    
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnG,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(rowTotalColumnG==0,VZ,VN)}" rendered="{!RenderColumnG}">                                                                                                    
<apex:param value="{!rowTotalColumnG}"/>                                                                                                    
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnH,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(rowTotalColumnH==0,VZ,VN)}" rendered="{!RenderColumnH}">                                                                                                    
<apex:param value="{!rowTotalColumnH}"/>                                                                                                    
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnI,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(rowTotalColumnI==0,VZ,VN)}" rendered="{!RenderColumnI}">                                                                                                    
<apex:param value="{!rowTotalColumnI}"/>                                                                                                    
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnJ,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(rowTotalColumnJ==0,VZ,VN)}" rendered="{!RenderColumnJ}">                                                                                                    
<apex:param value="{!rowTotalColumnJ}"/>                                                                                                    
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnK,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(rowTotalColumnK==0,VZ,VN)}" rendered="{!RenderColumnK}">                                                                                                    
<apex:param value="{!rowTotalColumnK}"/>                                                                                                    
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnL,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(rowTotalColumnL==0,VZ,VN)}" rendered="{!RenderColumnL}">                                                                                                    
<apex:param value="{!rowTotalColumnL}"/>                                                                                                    
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnM,'ffrcalcsumd','ffrhidden')}"><apex:outputText value="{!if(rowTotalColumnM==0,VZ,VN)}" rendered="{!RenderColumnM}">                                                                                                    
<apex:param value="{!rowTotalColumnM}"/>                                                                                                    
</apex:outputText></td>                                                                                                 
</tr>                                                                                                   
<!-- Make some vertical space before the next row -->                                                                                                   
<tr><td class="ffrgridspacerd" colspan="11"></td></tr>                                                                                                  
</apex:repeat> <!-- Go to the next row -->                                                                                                  
<!-- Display grand-total row -->                                                                                                    
<!-- The td tag needs to span the number of groups being rendered -->                                                                                                   
<tr>                                                                                                    
<td class="ffrcalcsumlabeld" colspan="11">{!Label['L12']}</td>                                                                                                  
<td class="ffrgridspacerd"/>                                                                                                   
<td class="{!if(RenderColumnA,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnA==0,VZ,VN)}" rendered="{!RenderColumnA}">                                                                                                  
<apex:param value="{!grandTotalColumnA}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnB,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnB==0,VZ,VN)}" rendered="{!RenderColumnB}">                                                                                                  
<apex:param value="{!grandTotalColumnB}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnC,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnC==0,VZ,VN)}" rendered="{!RenderColumnC}">                                                                                                  
<apex:param value="{!grandTotalColumnC}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnD,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnD==0,VZ,VN)}" rendered="{!RenderColumnD}">                                                                                                  
<apex:param value="{!grandTotalColumnD}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnE,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnE==0,VZ,VN)}" rendered="{!RenderColumnE}">                                                                                                  
<apex:param value="{!grandTotalColumnE}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnF,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnF==0,VZ,VN)}" rendered="{!RenderColumnF}">                                                                                                  
<apex:param value="{!grandTotalColumnF}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnG,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnG==0,VZ,VN)}" rendered="{!RenderColumnG}">                                                                                                  
<apex:param value="{!grandTotalColumnG}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnH,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnH==0,VZ,VN)}" rendered="{!RenderColumnH}">                                                                                                  
<apex:param value="{!grandTotalColumnH}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnI,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnI==0,VZ,VN)}" rendered="{!RenderColumnI}">                                                                                                  
<apex:param value="{!grandTotalColumnI}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnJ,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnJ==0,VZ,VN)}" rendered="{!RenderColumnJ}">                                                                                                  
<apex:param value="{!grandTotalColumnJ}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnK,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnK==0,VZ,VN)}" rendered="{!RenderColumnK}">                                                                                                  
<apex:param value="{!grandTotalColumnK}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnL,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnL==0,VZ,VN)}" rendered="{!RenderColumnL}">                                                                                                  
<apex:param value="{!grandTotalColumnL}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<td class="{!if(RenderColumnM,'ffrsubtotald','ffrhidden')}"><apex:outputText value="{!if(grandTotalColumnM==0,VZ,VN)}" rendered="{!RenderColumnM}">                                                                                                  
<apex:param value="{!grandTotalColumnM}"/>                                                                                                  
</apex:outputText></td>                                                                                                 
<!-- Spacer -->                                                                                                 
<tr><td class="ffrgridspacerd" colspan="11"></td></tr>                                                                                                  
</tr>                                                                                                   
</table>                                                                                                    
<!-- REGION 06: REPORT CHATTER START -->                                                                                                    
<ffr:ShowChatter value="{!ReportingLog}" rendered="{!PrintChatterFeed}"/>                                                                                                   
<!-- REGION 06: REPORT CHATTER END -->                                                                                                  
</apex:page>